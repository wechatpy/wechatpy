更新日志
================

Version 1.8.6
-----------------

Released on 2020-01-19

+ 功能 - 增加外部联系人标签管理API
+ 修复 - `dict_to_xml`函数设置`sign`参数可选
+ 文档 - 更新部分文档链接

Version 1.8.5
-----------------

Released on 2020-01-14

+ 功能 - 增加小程序内容安全相关的`check_image_security`和`check_text_security`接口
+ 功能 - 增加卡券相关的13种类型事件

Version 1.8.4
-----------------

Released on 2020-01-06

+ 功能 - 解析微信退款结果通知
+ 功能 - 添加一个直接通过xml获取appid的函数
+ 功能 - 新增小程序订阅消息发送接口
+ 功能 - 增加拉取所有已授权的帐号信息
+ 功能 - 微信客服消息支持 msgtype="link"
+ 功能 - 企业微信通讯录成员接口增加其他字段的支持
+ 功能 - 会员卡事件推送
+ 修复 - 企业微信获取员工时默认获取所有部门

Version 1.8.3
-----------------

Released on 2019-06-14

+ 功能 - 增加企业微信外部联系人的列表、详情、联系方式增删改查、企业模板、员工行为等接口
+ 功能 - 增加企业微信发送 `markdown` 消息的接口
+ 功能 - 增加企业微信映射员工字段的方法
+ 修复 - 修正类型继承不当，导致潜在类型误判的问题
+ 构建 - `tox` 增加对 `pip`/`setuptools` 的版本要求
+ 文档 - 修复发送文本卡片消息的参数说明
+ 文档 - 修复企业微信主动调用接口的文档格式

Version 1.8.2
-----------------

Released on 2019-04-12

+ “微信企业号”相关内容更新、整理到“企业微信”
+ 添加永久二维码的文档
+ 企业微信 - 消息推送API增加`send`接口，支持发送全部类型应用消息
+ 企业微信 - 群聊会话API增加`send`接口，支持发送全部类型会话消息
+ 企业微信 - JSAPI获取企业ticket、获取应用ticket分别提供函数用于“获取 ticket”和“通过 session 对象自动获取缓存 ticket”
+ 企业微信 - 新增“上传永久图片”和“获取高清语音素材”接口及文档
+ 企业微信 - 增加“获取第三方应用凭证”接口
+ 企业微信 - 所有获取部门成员相关接口，增加`simple`参数控制是否展示成员详情，参数默认值不会改变接口之前的返回结果
+ 企业微信 - 获取应用菜单，当菜单不存在，直接抛出异常，和其他接口行为保持一致（Break Change：旧接口会忽略异常并返回 None）

Version 1.8.1
-----------------

Released on 2019-04-01

+ 修复如果二维码参数中带 `qrscene_` ，关注处理消息时会被替换为空的 bug
+ 增加微信小程序开放数据解密 API
+ 从 PyPi 打包中去除测试用例代码

Version 1.8.0
-----------------

Released on 2019-03-15

+ 企业号部门 get 接口增加 `id` 默认参数
+ 移除了对 Python 3.4 的支持
+ 替换不再维护的 pycrypto 依赖为更安全的 pycryptodome
+ 增加小程序 `wx.login` 获取登录用户信息 API
+ `_http` 变为 `WeChatPay` 实例的属性，解决创建多个实例，发送请求时数据会串的问题
+ 增加获取企业微信应用 `jsapi_ticket` API
+ 增加反序列化被动响应接口
+ 增加企业微信群聊相关操作，如创建、发送群聊消息等
+ 增加营销接口
+ `iter_followers` API `first_user_id` 变为传参,当用户持有 `last_openid` 时,可选增量获取用户，用 `return` 代替 `StopIteration` 以避免在 Python 3.7 中出现 `RuntimeError`
+ 增加 `iter_tag_users` 方法,获取所有某标签下用户列表

Version 1.7.6
-----------------

Relased on 2019-01-04

+ 增加获取所有用户 openid API
+ 增加菜单进入小程序事件
+ 使用第三方代网页授权时，若 `component_access_token` 过期或无效自动刷新
+ 增加快速获取 pre auth url，可以直接微信中发送该链接，直接授权

Version 1.7.5
-----------------

Released on 2018-08-01

+ 修复 OAuth URL 生成可能触发 UnicodeDecodeError 的问题
+ 依赖 xmltodict 版本要求 >= 0.11.0
+ 微信支付接口增加 `sub_appid` 参数以支持小程序支付功能
+ 增加帐号迁移转换 openid API

Version 1.7.4
-----------------

Released on 2018-07-08

+ 支持透明背景微信小程序码

Version 1.7.3
-----------------

Released on 2018-07-04

+ 修复“主动发送消息给设备”接口参数错误
+ 修复“第三方主动发送设备状态消息给微信终端”接口参数错误

Version 1.7.1
-----------------

Released on 2018-07-03

+ PyPI 项目简介使用 markdown 格式
+ 微信支付增加下载资金账单接口
+ 微信支付沙盒模式问题修复

Version 1.7.0
-----------------

Release on 2018-05-02

+ 三方平台增加 parse_message 处理消息，token cache 在处理消息时自动处理
+ 微信小店新增部分接口
+ 微信支付退款接口增加可选的 `notify_url` 参数
+ 群发接口增加 `send_ignore_reprint` 和 `client_msg_id` 参数
+ 微信支付增加转账到银行卡接口

Version 1.6.1
------------------

+ 增加微信开放平台代公众号 OAuth 网页授权相关接口
+ 微信支付 sandbox 环境 API 问题i修复
+ 增加微信支付 jssdk 的 sandbox API 支持

Version 1.6.0
------------------

+ 增加微信代扣相关接口
+ 客服消息增加发送小程序页面接口
+ 创建小程序码接口增加小程序二维码的跳转页面参数
+ 微信支付增加 timeout 参数
+ 微信支付支持 sandbox 环境

Version 1.5.5
------------------

+ 企业微信支持文本卡片消息

Version 1.5.4
-------------------

+ 修复第三方平台重新获取 access token 代码 typo

Version 1.5.3
-------------------

+ 批量查询支付后投放卡券接口增加遗漏的 `type` 参数
+ `component_verify_ticket` TTL 延长到 20 分钟
+ 重构卡券更新会员信息接口
+ 重构卡券激活会员卡 - 接口激活方式
+ 卡券增加设置开卡字段接口
+ 增加卡券 `UserFormInfoFlag` 枚举常量
+ 发送卡券消息支持卡券扩展信息参数为空

Version 1.5.2
-------------------

+ 新增 `WeChatErrorCode` 类方便比较错误码
+ 修复永久素材更新图文素材接口问题
+ 修复微信硬件取消关注事件 key
+ 群发消息文档完善
+ 微信支付统一下单接口增加 `scene_info` 字段
+ 获取标签下粉丝列表 API 更改为 HTTP POST

Version 1.5.1
-------------------

Released on 2017-08-02

+ 增加微信电子发票接口
+ 补全微信发票相关接口
+ 修复微信小程序修改服务器域名和获取审核状态接口

Version 1.5.0
-------------------

Released on 2017-07-26

+ 模板消息增加获取设置的行业信息接口
+ 新增部分微信小程序接口
+ 支持 HTTP keepalive
+ 修复设备事件解析 regression
+ 新增模板消息一次性订阅消息接口
+ 新增黑名单用户管理接口
+ 永久素材接口允许设置评论开放与否

Breaking Changes:

+ 不再支持 Python 2.6 和 Python 3.3

Version 1.4.2
-------------------

Released on 2017-07-12

+ 增加群发文章评论相关接口
+ 增加小程序二维码相关接口
+ 设备获取二维码接口增加 `product_id` 参数
+ 修复设备被动响应事件解析问题
+ 修复永久素材获取视频消息问题
+ 增加获取模板列表和删除模板接口

Breaking Changes:

+ 客服 `get_records` 接口更新，返回值更改为 `dict`
+ 修复设备相关接口返回数据不正确的问题

Version 1.4.1
-------------------

Released on 2017-04-22

+ 修复模板消息小程序支持

Breaking Changes:

+ 模板消息接口 `url` 参数为可选参数

Version 1.4.0
------------------

Released on 2017-04-22

+ 微信硬件接口部分更新
+ `jsapi_ticket` session 存储 key 增加 appid/corp_id 前缀
+ 修复 OAuth `redirect_uri` 编码问题
+ 增加微信卡券 ticket 获取及签名
+ 更新企业号登录授权相关接口
+ WeChatPayException 在 str() 和 repr() 里增加更详细的错误描述
+ 微信支付退款接口增加退款资金来源参数
+ 更新微信小店接口 URL
+ 增加用户标签管理接口（替换原分组接口）
+ memcached session 对 python-memcached 和 pymemcache 支持 `ttl` 参数
+ 模板消息支持打开小程序

Breaking Changes:

+ 根据最新的微信支付文档增加删除了一些参数
+ send_template 根据最新文档移除 top_color 参数

Version 1.3.1
------------------

Release on 2017-02-06

+ 修复企业号部分接口传参不全的问题

Version 1.3.0
-------------------

Release on 2017-01-08

+ 降低 JSON/XML 解析出错时的日志级别
+ 移除废弃的企业号邀请成员关注接口
+ 微信支付增加撤销订单和授权码转换 openid 接口
+ 部分文档更新

Version 1.2.15
---------------------

+ 微信连 Wi-Fi 增加获取店铺信息接口
+ 批量获取用户信息接口修复及文档更新

Version 1.2.14
---------------------

+ 增加企业号部分文档
+ 卡券事件更新

Version 1.2.13
----------------------

+ 增加解析微信支付结果 API
+ 增加被动响应空回复

Version 1.2.10
-----------------------

+ 微信企业号支持链接消息
+ ``WeChatPayException`` 信息优化

Version 1.2.9
------------------------

+ 卡券接口更新

Version 1.2.8
-------------------------

+ 增加获取 APP 支付参数函数
+ 修复统一下单接口部分时间参数时区问题
+ 修复微信支付空参数签名不正确的 bug
+ 增加验证微信支付结果参数签名 API

Version 1.2.7
------------------------

+ 修复卡券接口 URL
+ 统一下单接口支持指定支付方式
+ ``wechatpy._compat`` 中部分函数移到 ``wechatpy.utils`` 模块中

Version 1.2.6
---------------------

+ 增加微信扫一扫接口和事件
+ 修复企业号 OAuth 接口 bug
+ 更新了一些文档

Version 1.2.5
---------------------

+ 暂时移除 ``setup.py`` 中的 ``namespace_package`` 参数

Version 1.2.4
----------------------

+ 修复永久素材接口 URL 错误问题

Version 1.2.1
---------------------

+ 修复数据统计接口 URL 错误问题
+ 增加认证相关消息推送解析
+ ``WeChatClient`` 增加 ``timeout`` 参数控制请求超时
+ 图文消息接口支持发送微信开放平台图文素材消息
+ 单元测试由 nose 切换到 py.test

Version 1.2.0
-----------------------

+ 修复第三方平台相关接口问题，更新文档

Version 1.1.2
--------------------
+ 增加企业号摇一摇周边接口
+ 增加部分企业号第三方平台接口
+ 增加部分企业号会话接口
+ 增加刷卡支付功能接口

Version 1.1.1
-------------------
+ 修复微信支付 JS API 签名问题

Version 1.1.0
-------------------
+ 增加微信公众号第三方平台接口, 感谢 @hunter007 的贡献

Version 1.0.5
--------------------
+ 修复 Python 3 下解密消息报 TypeError 的 bug

Version 1.0.4
---------------------
+ 摇一摇周边接口 bug 修复
+ 更新自动重试的 error codes
+ ``WeChatClient._request`` 方法在解析 JSON 失败时返回原始 Response 对象

Version 1.0.3
---------------------
+ 群发消息增加上传图片接口
+ 修复下载永久素材接口错误

Version 1.0.2
---------------------
+ ``WeChatClient`` 初始化性能提升（Python 2.7+）
+ ``WeChatClient`` 数据乱码问题解决
+ Session storage ``get`` 方法增加可选默认值参数

Version 1.0.1
---------------------
+ 修复微信支付接口中文乱码问题
+ 微信支付订单查询接口 ``client_ip`` 参数可选，并修复了一些问题
+ 增加微信连 Wi-Fi 接口
+ 摇一摇周边接口增加 ``get_apply_status`` 接口
+ 摇一摇周边 ``add_material`` 接口增加 ``media_type`` 可选参数

Version 1.0.0
---------------------
+ 增加 Session 机制，目前只用来存储 access_token 等，支持 Redis, Memcached, 内存和 Shove 等存储 backend.
+ 增加微信门店接口
+ 增加摇一摇周边事件，添加页面接口增加 ``page_url`` 参数
+ reraise ``requests.RequestException`` 为 ``WeChatClientException``
+ 修复继承 ``WeChatClient`` 导致不能正常工作的问题
+ 企业号增加素材管理接口
+ 企业号增加 JS SDK API
+ 企业号增加 ``user_id`` 和 ``openid`` 互相转换接口
+ 企业号增加 OAuth 授权接口

Version 0.9.1
---------------------
+ 群发预览接口支持对指定微信号发送预览
+ 增加微信支付现金红包接口
+ 增加微信支付代金券接口
+ 增加微信支付企业付款接口
+ 增加微信支付公众号支付接口

Version 0.9.0
---------------------

+ 代码层面 API Endpoint 从实例属性变为类属性，在实例化后依然会和对应的实例绑定。此更改对库使用者而言是透明的。
+ `WeChatClient` 原有的 `_get` 和 `_post` 更名 `get` 和 `post`, 以前的接口依然保留。对于 wechatpy 没有实现的接口，可以使用 `get` 和 `post` 自行实现。

Version 0.8.7
--------------------

+ 修复多客服接口多个问题

Version 0.8.7
------------------

+ 修复群发视频上传视频证书验证不通过的问题
+ 增加了删除分组接口
+ 增加了发送卡券消息接口
+ 增加了群发卡券消息接口

Version 0.8.6
-------------------

+ 修复了图文消息图文数量一直递增的问题
+ 从此版本开始不再支持 Python 3.2（cryptography 不支持，PyCrypto 应该还可以）
+ 从此版本开始 Travis CI 上增加了 Python nightly build（Python 3.5-dev） 的测试

Version 0.8.5
-------------------

+ WeChatOAuth 增加 qrconnect_url 属性
+ 被动响应消息增加 create_time 属性（通过解析 time 时间戳获得的 datetime.datetime 对象）
+ 增加了模板消息设置行业接口
+ 增加了模板消息获取模板 ID 接口

Version 0.8.4
--------------------

+ 修复了 WeChatOAuth 编码问题
+ 修复了企业号更新部门接口 parentid 参数错误问题
+ 企业号创建部门接口增加 order 和 id 可选参数

Version 0.8.3
--------------------

+ 群发消息接口增加 is_to_all 参数
+ 群发消息接口支持预览（增加 preview 参数）
+ 修复了群发消息的一个 bug
+ 素材管理接口增加获取素材数量 API

Version 0.8.2
---------------------

+ 修复 WeChatClient access_token 过期自动重试的一个 bug
+ 增加摇一摇周边接口
+ 增加设备功能接口

Version 0.8.1
---------------------

+ 增加获取菜单配置接口
+ 增加获取自动回复规则接口
+ 更新客服消息接口，支持使用特定客服账号发送消息
+ 修复 OAuth 验证接口错误

Version 0.8.0
---------------------

+ 消息加解密兼容 cryptography 和 PyCrypto 库
+ 企业号增加异步任务接口
+ 增加小视频消息类型

Version 0.7.6
---------------------

+ 增加 JSSDK 接口
+ 增加语义理解接口
+ 增加素材管理接口
+ 增加客服会话管理接口
+ 企业号增加 agent 管理接口
